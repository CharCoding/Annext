<!DOCTYPE html>
<html>
<head>
	<title>Annext</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
	<link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css" rel="stylesheet" type="text/css" />
	<link href="favicon.ico" rel="icon" type="image/x-icon" />
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>
	<script type="text/javascript" src="js/wordgen.min.js"></script>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<style type="text/css">
	body {
		position: absolute;
		left: 0;
		right: 0;
		top: 0;
		bottom: 0;
		margin: 0;
		background-color: #000;
		font-family: Roboto, Helvectica, sans-serif;
		overflow: hidden;
	}
	body > div {
		position: absolute;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		margin: 0;
	}
	#game {
		left: 100%;
	}
	.display { position: absolute; left: 0; width: 100%; text-align: center; color: #fff; }
	h1.display { top: 0; font-size: 112px !important; font-weight: 300 !important; }
	h4.display { top: 144px; }
	.preloader-wrapper {
		position: absolute;
		left: 50%;
		top: 50%;
		margin-left: -24px;
		margin-top: -64px;
	}
	#games {
		position: absolute;
		left: 20%;
		right: 20%;
		top: 240px;
		overflow-y: auto;
		display: none;
	}
	#x {
		display: inline-block;
		transition: transform 200ms;
	}
	h1.display:hover > #x {
		transform: rotateY(180deg);
	}
	#start {
		position: absolute;
		top: 256px;
		left: 0;
		right: 0;
		bottom: 0;
	}
	#join {
		margin-right: -32px;
		margin-top: -8px;
	}
	#credits {
		position: absolute;
		bottom: 0;
		width: 100%;
		text-align: center;
		color: white;
	}
	.input-field input[type=text]:focus + label {
		color: #E91E63;
	}
	.input-field input[type=text]:focus {
		border-bottom: 1px solid #E91E63;
		box-shadow: 0 1px 0 0 #E91E63;
	}
	#logo {
		padding-left: 8px;
		padding-top: 8px;
	}
	#action {
		display: none;
	}
	.circle { /* Can't believe they don't have this class. Well, here goes browser-compatibility... */
		width: 48px;
		height: 48px;
		text-align: center;
		padding: 0 !important;
		margin: 0 !important;
		border-radius: 50%;
	}
	.tabcontent {
		position: absolute;
		left: 0;
		top: 112px;
		right: 0;
		bottom: 0;
	}
	canvas {
		position: absolute;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}
	</style>
</head>
<body>
	<div id="home">
		<h1 class="display">Anne<img id="x" src="./images/x.png" width="69" height="60" alt="x" />t</h1>
		<h4 class="display">Next Level World Domination</h4>
		<div id="start">
			<div class="row">
				<div class="col s2 offset-s3 white-text"><h4 style="text-align: right;">ws://</h4></div>
				<div class="col s1 input-field white-text">
					<input type="text" id="url" class="validate" required="required" placeholder="Server code" maxlength="8" size="8" pattern="^[a-f\d]{8}$" data-error="Invalid code" data-successs="Looks good!" />
				</div>
				<div class="col s2 white-text">
					<h4>.ngrok.io <a id="join" class="btn-floating btn-large waves-effect waves-light pink right"><i class="material-icons">arrow_forward</i></a></h4>
				</div>
			</div>
			<div class="row">
				<div class="col s2 offset-s5 center-align">
					<a href="#" class="btn btn-large waves-effect waves-light indigo white-text">Manual</a>
				</div>
			</div>
		</div>
		<p id="credits">&copy; 2017 Annext by <a class="pink-text" href="http://github.com/CharCoding/" title="GitHub">CharCoding</a>, All Rights Reserved.</p>
		<!-- We might not need this, since all servers are forwarded to ngrok.io -->
		<!--div id="load" class="preloader-wrapper active">
			<div class="spinner-layer spinner-blue">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div><div class="gap-patch">
					<div class="circle"></div>
				</div><div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
			<div class="spinner-layer spinner-red">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div><div class="gap-patch">
					<div class="circle"></div>
				</div><div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
			<div class="spinner-layer spinner-yellow">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div><div class="gap-patch">
					<div class="circle"></div>
				</div><div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
			<div class="spinner-layer spinner-green">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div><div class="gap-patch">
					<div class="circle"></div>
				</div><div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
		</div>
		<ul id="games" class="collection with-header">
			<li class="collection-header">
				<h4>Games<a id="createbtn" class="btn-floating waves-effect waves-light indigo secondary-content right-align"><i class="material-icons">add</i></a></h4>
			</li>
			<li class="collection-item avatar">
				<i class="material-icons circle white green-text">public</i>
				<span class="title">AnnexTheWorld</span>
				<p><span class="green-text">3 / 8</span><br />Earth</p>
				<a href="" class="secondary-content"><i class="material-icons medium">keyboard_arrow_right</i></a>
			</li>
			<li class="collection-item avatar">
				<i class="material-icons circle red">lock</i>
				<span class="title">New Imperialism</span>
				<p><span class="green-text">5 / 8</span><br />The World of AMOC</p>
				<a id="privateGame" href="" class="secondary-content"><i class="material-icons medium">keyboard_arrow_right</i></a>
			</li>
			<li class="collection-item avatar">
				<i class="material-icons circle white green-text">public</i>
				<span class="title">World Domination 101</span>
				<p><span class="red-text">8 / 8</span><br />Random Map</p>
				<a href="" class="secondary-content"><i class="material-icons orange-text medium">keyboard_arrow_right</i></a>
			</li>
		</ul>
		<div id="create" class="modal modal-fixed-footer">
			<div class="modal-content">
				<h4>Create Game</h4>
				<div class="row">
					<div class="col s6 input-field">
						<input type="text" id="name" class="validate" required="required" maxlength="24" /><label for="name">Game Name</label>
					</div>
					<div class="col s6 input-field">
						<input type="checkbox" id="private" /><label for="private">Private</label>
					</div>
				</div>
				<div class="row">
					<div class="col s6 input-field">
						<input type="password" id="password" class="validate" required="required" disabled="disabled" /><label for="password">Password</label>
					</div>
					<div class="col s6 input-field">
						<select>
							<option value="1" selected="selected">Earth</option>
							<option value="2">The World of AMOC</option>
							<option value="3">Randomized</option>
						</select>
						<label>Map</label>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<a href="#!" class="modal-action modal-close blue-text waves-effect waves-blue btn-flat">Create</a>
				<a href="#!" class="modal-action modal-close blue-text waves-effect waves-red btn-flat">Cancel</a>
			</div>
		</div-->
	</div>
	<div id="game">
		<nav class="nav-extended">
			<div class="nav-wrapper indigo">
				<a href="#" class="brand-logo">
					<img id="logo" src="./images/x.png" width="46" height="40" alt="x" />
					<span id="countryName"></span>
				</a>
				<ul class="right">
					<li><a href="#!"><i class="material-icons left">launch</i>Manual</a></li>
					<li><a href="#!" id="chatBtn"><i class="material-icons right">chat</i>Chat</a></li>
				</ul>
			</div>
			<div class="nav-content">
				<ul class="tabs tabs-transparent indigo">
					<li class="tab"><a href="#map">Map</a></li>
					<li class="tab"><a href="#history">Order History</a></li>
					<li class="tab"><a href="#stats">Statistics</a></li>
					<li class="tab disabled"><a href="#battle">Battle</a></li>
				</ul>
			</div>
		</nav>
		<div id="map" class="col s12 tabcontent">
			<canvas id="c"></canvas>
			<div id="action" class="fixed-action-btn horizontal">
				<a class="btn-floating btn-large pink">
					<i class="large material-icons">add</i>
				</a>
				<ul>
					<li><a id="cityBtn" class="btn-floating blue-grey"><i class="material-icons">location_city</i></a></li>
					<li><a id="militaryBtn" class="btn-floating red"><i class="material-icons">gps_fixed</i></a></li>
					<li><a id="buildBtn" class="btn-floating yellow darken-1"><i class="material-icons">build</i></a></li>
					<li><a id="tradeBtn" class="btn-floating green"><i class="material-icons">attach_money</i></a></li>
				</ul>
			</div>
		</div>
		<div id="history" class="col s12 tabcontent">

		</div>
		<div id="stats" class="col s12 tabcontent">

		</div>
		<div id="battle" class="col s12 tabcontent">

		</div>
		<!-- Sidenav always hides when blurred, implementing my own -->
		<!--ul id="side-chat" class="side-nav">
			<li>
				<div class="row valign-wrapper">
					<div class="col s9">
						<h4>Chat</h4>
					</div>
					<div class="col s3 valign-wrapper right-align"><a href="#" id="closeChat" class="btn-flat circle waves-effect waves-light gray-text right"><i class="material-icons">arrow_forward</i></a></div>
				</div>
			</li>
			<li><div class="divider"></div></li>
		</ul-->
		<div id="chatbox">
			<div class="row">
				<div class=""></div>
			</div>
		</div>
		<div id="countryModal" class="modal">
			<div class="modal-content">
				<h4>Name of Your Country:</h4>
				<div class="row">
					<div class="col s6 input-field">
						<input id="countryInput" class="validate" type="text" maxlength="32" pattern="^[A-Za-z][A-Za-z ]+$" data-error="Invalid country name" data-success="Sounds great!" /><label for="country">Country Name:</label>
					</div>
					<div class="col s6">
						<a id="generateName" class="btn waves-effect waves-light pink white-text">GENERATE <i class="material-icons right">refresh</i></a>
					</div>
				</div>
				<div class="row">
					<div class="col s12">Try to come up with a name that doesn't reveal your identity, so that the game can be less personal.<br />A country name can only contain letters and spaces.<br />You CANNOT change the country name once you press CONFIRM.</div>
				</div>
			</div>
			<div class="modal-footer">
				<a href="#!" id="submitName" class="disabled btn modal-action modal-close waves-effect waves-light indigo white-text">CONFIRM</a>
			</div>
		</div>
	</div>
	<script type="text/javascript">
	var player = {
		countryName: "",
		capital: {
			x: 0,
			y: 0,
			z: 0,
			name: "",
			captured: false
		},
		$development: 0,
		$city: 0,
	};
	$(document).ready(function(){
		const countryRegex = /^[a-z]+( ?[a-z]+)+ ?[a-z]$/i;
		$('#countryInput').on('change input',function(){
			let val = $(this).val();
			if(val.length > 3 && val.length < 33 && countryRegex.test(val)) $('#submitName').removeClass('disabled');
			else $('#submitName').addClass('disabled');
		});
		$('#join').on('click',function(){
			$('#home').animate({"left": "-100%"}, 400);
			$('#game').animate({"left": "0"}, 400);
			$('#countryModal').modal({dismissible: false, inDuration: 250, complete: function() {
				if(player.countryName && $('#countryInput').val().trim() == '') return;
				if($('#countryInput').val().trim() == '') player.countryName = word(2,1).capitalize();
				else player.countryName = $('#countryInput').val().capitalize();
				$('#countryName').text(' ' + player.countryName);
				$('#countryModal').remove();
				// TODO: Send country object to server
			}});
			$('#countryModal').modal('open');
			$('#action,#navigator').fadeIn(400);
		});
		//$('#chatBtn').sideNav({menuWidth: 360, edge: 'right', closeOnClick: false});
		$('#closeChat').on('click',function(){
			$('#side-chat').removeClass('fixed').sideNav('hide');
			//$('#chatBtn').sideNav({edge: 'right', closeOnClick: false}).sideNav('hide');
		});
		$('#chatBtn').on('click',function(){
			$('#side-chat').sideNav('show').addClass('fixed');
			//$('#chatBtn').sideNav({edge: 'right', closeOnClick: false});
		});
		$('#generateName').on('click',function(){
			$('#countryInput').val(word(2,1).capitalize());
			$('#submitName').removeClass('disabled');
			Materialize.updateTextFields();
		});
		Materialize.updateTextFields();
		$(window).on('resize',canvasSize);
	});
	function canvasSize(){
		c.width = $('#c').width();
		c.height = $('#c').height();
	}
	canvasSize();
	//var t = c.getContext('2d');
	/* // Code for room joining/creating
	function onWebSocketConnect(){
		$('#load').fadeOut();
		$('#games').slideToggle();
	}
	$(document).ready(function(){
		$('select').material_select();
		$('#load').on('click',onWebSocketConnect);
		$('#createbtn').on('click',function(){
			$('#create').openModal();
		});
		$('#private').on('click',function(){
			var c = $('#private').is(':checked')
			$('#password').prop('disabled', !c);
			if (!c) {
				$('#password').removeClass('valid').removeClass('invalid');
			} else {
				if($('#password').val() == '') $('#password').removeClass('valid').addClass('invalid');
				else $('#password').removeClass('invalid').addClass('valid');
			}
		});
		$('#privateGame').on('click',function(){

		});
		$('#name').on('blur keyup',function(){
			if($('#name').val().trim() == '') $('#name').addClass('invalid');
			else $('#name').removeClass('invalid').addClass('valid');
		});
		$('#password').on('blur keyup',function(){
			if($('#password').val() == '' && $('#private').is(':checked')) $('#password').addClass('invalid');
			else $('#password').removeClass('invalid').addClass('valid');
		});
	});
	//*/
	var t = c.getContext('2d'), mapData = [], matrix = [1,0,0,1,0,0];
	for(var i = 0; i < 31; i++){
		for(var j = 0, k = 31 - Math.abs(i - 15); j < k; j++){

		}
	}
	function drawHex(x, y, color) {
		t.beginPath();
		t.moveTo(x + 25, y);
		for(var i=1;i<6;i++){
			t.lineTo(x + Math.cos(Math.PI * i / 3) * 25, y + Math.sin(Math.PI * i / 3) * 25);
		}
		t.fillStyle = color || '#0035cf';
		t.fill();
	}
	const cube2Axial = (x, y, z) => [x, z],
		axial2Cube = (q, r) => [q, r, -q - r],
		cube2Offset = (x, y, z) => [x, z + (x + (x & 1)) / 2],
		offset2Cube = (col, row) => [col, (col + (col & 1)) / 2 - row - col, row - (col + (col & 1)) / 2];
	</script>
</body>
</html>